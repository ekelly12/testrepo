parameters:
  - name: CoreDest
    type: string
  - name: ArtifactTargetFolder
    type: string

steps:
  - task: CmdLine@2
    displayName: "Preparing for core dump captures"
    inputs:
      script: |
        echo "##vso[task.setvariable variable=CoreDest]${{ parameters.CoreDest }}"
        echo "##vso[task.setvariable variable=ArtifactTargetFolder]${{ parameters.ArtifactTargetFolder }}"
        if [ ! -d "$(ArtifactTargetFolder)" ]; then mkdir "$(ArtifactTargetFolder)"; fi
        $(Build.SourcesDirectory)/script/CaptureCritical/setup.sh $(Build.SourcesDirectory)/script/CaptureCritical ${{ parameters.CoreDest }}
